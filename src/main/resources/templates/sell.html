<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBS - Sell an Item</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background-color: #f3f4f6;
        }
        .dropzone {
          border: 2px dashed #e5e7eb;
          border-radius: 0.5rem;
          /* transition: all 0.3s ease; */
        }
        .dropzone:hover, .dropzone.highlight {
          border-color: #8B5CF6;
          background-color: #F5F3FF;
        }
        .image-preview {
          position: relative;
          width: 100px;
          height: 100px;
          overflow: hidden;
          border-radius: 0.5rem;
        }
        .image-preview img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
        .image-preview .remove-btn {
          position: absolute;
          top: 0;
          right: 0;
          background-color: rgba(239, 68, 68, 0.8);
          color: white;
          width: 24px;
          height: 24px;
          border-radius: 0 0.5rem 0 0.5rem;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
        }
        .file-input {
          display: none;
        }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="bg-white shadow-md">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
            <div class="flex">
                <div class="flex-shrink-0 flex items-center">
                    <span class="text-purple-600 text-xl font-bold">BBS</span>
                </div>
                <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                    <a href="/home" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Home</a>
                    <a href="/auctions" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Auctions</a>
                    <a href="/mybids" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">My Bids</a>
                    <a href="/sell" class="border-purple-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Sell Item</a>
                </div>
            </div>
            <div class="hidden sm:flex sm:items-center">
                <a href="/myaccount" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">My Account</a>
            </div>
            <div class="flex items-center sm:hidden">
                <button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-purple-500">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </div>
</nav>

<!-- Page Header -->
<div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white py-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-3xl font-bold">Sell an Item</h1>
        <p class="mt-2">List your item for auction to the university community</p>
    </div>
</div>

<!-- Main Content -->
<div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="p-8">
            <form id="listingForm" method="post" action="/sell" enctype="multipart/form-data">
                <!-- Item Information Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Item Information</h2>

                    <div class="mb-4">
                        <label for="itemTitle" class="block text-gray-700 text-sm font-medium mb-2">Item Title <span class="text-red-500">*</span></label>
                        <input type="text" id="itemTitle" name="itemTitle" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="E.g., Sony WH-1000XM4 Headphones" required>
                        <p class="text-xs text-gray-500 mt-1">Be specific and include brand names if applicable</p>
                    </div>

                    <div class="mb-4">
                        <label for="itemCondition" class="block text-gray-700 text-sm font-medium mb-2">Condition <span class="text-red-500">*</span></label>
                        <select id="itemCondition" name="itemCondition" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                            <option value="" disabled selected>Select condition</option>
                            <option value="new">New (unused with original packaging)</option>
                            <option value="like-new">Like New (barely used, looks new)</option>
                            <option value="good">Good (some signs of use, works perfectly)</option>
                            <option value="fair">Fair (noticeable wear, fully functional)</option>
                            <option value="poor">Poor (heavy wear, may have issues)</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label for="description" class="block text-gray-700 text-sm font-medium mb-2">Description <span class="text-red-500">*</span></label>
                        <textarea id="description" name="description" rows="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Describe your item in detail including any defects, features, age, etc." required></textarea>
                        <p class="text-xs text-gray-500 mt-1">Be honest about the condition and include all relevant details</p>
                    </div>
                </div>

                <!-- Upload Photos Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Upload Photos</h2>

                    <div class="mb-4">
                        <div id="dropzone" class="dropzone p-6 flex flex-col items-center justify-center cursor-pointer">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                            <p class="text-gray-700 mb-1">Select images for your listing</p>
                            <button type="button" id="browseFiles" class="text-purple-600 font-medium hover:text-purple-800">Browse files</button>
                            <input type="file" id="fileInput" name="images" class="file-input" accept="image/*" multiple>
                            <p class="text-xs text-gray-500 mt-3">Upload 2-8 images (JPG, PNG, max 5MB each)</p>
                        </div>
                    </div>

                    <div id="imagePreviewContainer" class="flex flex-wrap gap-3">
                        <!-- Image previews will be added here dynamically -->
                    </div>
                </div>

                <!-- Auction Details Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Auction Details</h2>

                    <div class="mb-4">
                        <label for="startingPrice" class="block text-gray-700 text-sm font-medium mb-2">Starting Price (₹) <span class="text-red-500">*</span></label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span class="text-gray-500">₹</span>
                            </div>
                            <input type="number" id="startingPrice" name="startingPrice" class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="0.00" min="0" step="0.01" required>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Set a reasonable starting price to attract bidders</p>
                    </div>

                    <div class="mb-4">
                        <label for="auctionDuration" class="block text-gray-700 text-sm font-medium mb-2">Auction Duration <span class="text-red-500">*</span></label>
                        <select id="auctionDuration" name="auctionDuration" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                            <option value="" disabled selected>Select duration</option>
                            <option value="0">5 Minutes</option>
                            <option value="3">3 Days</option>
                            <option value="7">7 Days</option>
                        </select>
                    </div>
                </div>

                <!-- Contact Information Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Contact Information</h2>

                    <div class="mb-4">
                        <label for="phone" class="block text-gray-700 text-sm font-medium mb-2">Phone Number for Bidders <span class="text-red-500">*</span></label>
                        <input type="tel" id="phone" name="phone" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Your contact number" required>
                        <p class="text-xs text-gray-500 mt-1">Only shown to winning bidder after auction ends</p>
                    </div>

                    <div class="mb-4">
                        <label for="preferredMeetingLocation" class="block text-gray-700 text-sm font-medium mb-2">Preferred Meeting Location <span class="text-red-500">*</span></label>
                        <select id="preferredMeetingLocation" name="preferredMeetingLocation" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                            <option value="" disabled selected>Select location</option>
                            <option value="SOM">SOM</option>
                            <option value="library">Library</option>
                            <option value="cafeteria">Cafeteria</option>
                            <option value="main entrance">Main Entrance</option>
                            <option value="courtyard">Courtyard</option>
                            <option value="phase 3 hostel">Phase 3 Hostel</option>
                            <option value="other">Other (specify in description)</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">Choose a safe, public location on campus</p>
                    </div>
                </div>

                <!-- Terms and Submission Section -->
                <div class="mb-6">
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200 mb-4">
                        <h3 class="font-medium text-gray-800 mb-2">Important Guidelines</h3>
                        <ul class="text-sm text-gray-700 space-y-1 list-disc pl-5">
                            <li>All information must be accurate and truthful</li>
                            <li>You must be the owner of the item or authorized to sell it</li>
                            <li>Prohibited items will be removed and may result in account suspension</li>
                            <li>You are responsible for completing the transaction with the winning bidder</li>
                            <li>Your listing will be reviewed before it goes live (typically within 24 hours)</li>
                        </ul>
                    </div>

                    <div class="flex items-start mb-6">
                        <div class="flex items-center h-5">
                            <input id="agreeTerms" name="agreeTerms" type="checkbox" class="focus:ring-purple-500 h-4 w-4 text-purple-600 border-gray-300 rounded" required>
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="agreeTerms" class="text-gray-700">I agree to the <a href="terms.html" class="text-purple-600 hover:text-purple-800">Terms and Conditions</a> and certify that my listing complies with all platform guidelines</label>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition duration-300 font-medium">Create Listing</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Tips Section -->
    <div class="mt-8 bg-white rounded-lg shadow-md overflow-hidden">
        <div class="p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Tips for a Successful Auction</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-medium text-purple-700 mb-2">Getting the Best Price</h3>
                    <ul class="text-sm text-gray-700 space-y-2">
                        <li>• Take clear, well-lit photos from multiple angles</li>
                        <li>• Be honest about any defects or issues</li>
                        <li>• Set a reasonable starting price to attract more bidders</li>
                        <li>• Respond promptly to questions from potential bidders</li>
                        <li>• Include brand names and specific details in your title</li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-medium text-purple-700 mb-2">Safety Considerations</h3>
                    <ul class="text-sm text-gray-700 space-y-2">
                        <li>• Always meet in public, populated areas on campus</li>
                        <li>• Meet during daylight hours when possible</li>
                        <li>• Let a friend know when and where you're meeting</li>
                        <li>• Inspect any items carefully before accepting payment</li>
                        <li>• Trust your instincts - if something feels off, walk away</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Simple Copyright Footer -->
<div class="text-center text-gray-500 text-sm py-6 mt-12">
    <p>&copy; 2025 Buy Bid Save. All rights reserved.</p>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM elements
      const dropzone = document.getElementById('dropzone');
      const fileInput = document.getElementById('fileInput');
      const browseFiles = document.getElementById('browseFiles');
      const imagePreviewContainer = document.getElementById('imagePreviewContainer');
      const listingForm = document.getElementById('listingForm');

      // Constants
      const MAX_IMAGES = 8;
      const MIN_IMAGES = 2;
      const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB

      // Open file browser when clicking on browse button
      browseFiles.addEventListener('click', () => fileInput.click());

      // Handle file selection through the file input element
      fileInput.addEventListener('change', (event) => {
        // Replace existing files with new selection instead of adding to them
        const newFiles = Array.from(event.target.files);
        updateFileInput(newFiles);
      });

      // We're removing drag and drop functionality to avoid duplicate previews
      // The dropzone will only work as a visual element and button target

      // Form submission validation
      listingForm.addEventListener('submit', (event) => {
        // Validate minimum image requirement
        if (fileInput.files.length < MIN_IMAGES) {
          event.preventDefault();
          alert(`Please upload at least ${MIN_IMAGES} images of your item.`);
          return false;
        }

        // Validate terms agreement
        if (!document.getElementById('agreeTerms').checked) {
          event.preventDefault();
          alert('You must agree to the terms and conditions to proceed.');
          return false;
        }

        // If validation passes, the form will submit normally
        return true;
      });

      // Process selected files
      function handleFiles(newFiles) {
        // Check if adding these files would exceed the maximum
        if (newFiles.length > MAX_IMAGES) {
          alert(`You can only upload a maximum of ${MAX_IMAGES} images.`);
          return;
        }

        // Validate and filter new files
        const validFiles = [];

        for (const file of newFiles) {
          // Validate file type
          if (!file.type.match('image.*')) {
            alert('Please upload only image files (JPG, PNG).');
            continue;
          }

          // Validate file size
          if (file.size > MAX_FILE_SIZE) {
            alert('File size should not exceed 5MB.');
            continue;
          }

          validFiles.push(file);
        }

        if (validFiles.length === 0) return;

        // Use the valid files directly (replace existing selection)
        updateFileInput(validFiles);
      }

      // Update the file input with the current selection of files
      function updateFileInput(files) {
        // Create a new DataTransfer object
        const dataTransfer = new DataTransfer();

        // Add all files to the DataTransfer object
        files.forEach(file => dataTransfer.items.add(file));

        // Set the file input's files to the DataTransfer object's files
        fileInput.files = dataTransfer.files;

        // Update previews
        refreshPreviews();
      }

      // Remove image from selection
      function removeImage(index) {
        const files = Array.from(fileInput.files);
        files.splice(index, 1);
        updateFileInput(files);
      }

      // Refresh image previews
      function refreshPreviews() {
        imagePreviewContainer.innerHTML = '';

        Array.from(fileInput.files).forEach((file, index) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const previewElement = createImagePreview(e.target.result, index);
            imagePreviewContainer.appendChild(previewElement);
          };
          reader.readAsDataURL(file);
        });
      }

      // Create image preview element
      function createImagePreview(src, index) {
        const previewDiv = document.createElement('div');
        previewDiv.className = 'image-preview';
        previewDiv.dataset.index = index;

        const img = document.createElement('img');
        img.src = src;
        img.alt = 'Image Preview';

        const removeBtn = document.createElement('div');
        removeBtn.className = 'remove-btn';
        removeBtn.innerHTML = '<i class="fas fa-times"></i>';
        removeBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          removeImage(index);
        });

        previewDiv.appendChild(img);
        previewDiv.appendChild(removeBtn);

        return previewDiv;
      }
    });
</script>
</body>
</html>